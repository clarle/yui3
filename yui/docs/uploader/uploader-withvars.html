<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Example: Single File Upload with Additional Data - YUI Library</title>

    
    <script>var _sf_startpt=(new Date()).getTime();</script>

    
    
    

    
        <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Maven+Pro:400,700">
    
        <link rel="stylesheet" href="http://yui.yahooapis.com/3.4.0/build/cssgrids/grids-min.css">
    

    
        <link rel="stylesheet" href="/yui3/combo/css-main-min.css">
    

    
    <link rel="stylesheet" href="/yui3/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="/yui3/css/docs-min.css">


    <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
    <meta http-equiv="X-XRDS-Location" content="/xrds.xml">
    <link rel="shortcut icon" type="image/png" href="/yui3/img/favicon.png">

    
    
        
        


    <script>var YUI_config={"filter":"min","maxURLLength":1024,"groups":{"site":{"combine":true,"comboBase":"/combo/js?","root":"","modules":{"hoverable":{"path":"hoverable-min.js","requires":["event-hover","node-base","node-event-delegate"]},"search":{"path":"search-min.js","requires":["autocomplete","autocomplete-highlighters","node-pluginhost"]},"twitter-feed":{"path":"twitter-feed-min.js","requires":["escape","node","jsonp","gallery-torelativetime"]},"api-filter":{"path":"apidocs/api-filter-min.js","requires":["autocomplete-base","autocomplete-highlighters","autocomplete-sources"]},"api-list":{"path":"apidocs/api-list-min.js","requires":["api-filter","api-search","event-key","node-focusmanager","tabview"]},"api-search":{"path":"apidocs/api-search-min.js","requires":["autocomplete-base","autocomplete-highlighters","autocomplete-sources","escape"]}}}}};</script>


<script src="http://yui.yahooapis.com/3.4.1/build/yui/yui-min.js"></script>


    
</head>
<body class="yui3-skin-sam">

<a href="/yuiconf/2011/" class="yuiconf ribbon">
    <img src="/yui3/img/yuiconf/2011/ribbon.png" alt="YUIConf 2011">
</a>

<div id="doc">
    <div id="hd" class="yui3-g ribbonized"><header>
        <div class="content">
            <div class="yui3-u-3-4">
                <a href="/yui3" rel="home"><img class="logo" src="/yui3/img/yui-logo.png" alt="YUI Logo"></a>
            </div>

            <div class="yui3-u-1-4">
                <ul id="userinfo">

    <li><a href="/forum/ucp.php?mode=register">Register</a></li>
    <li><a href="/forum/ucp.php?mode=login&amp;redirect=/yui/docs/uploader/uploader-withvars.html">Log in</a></li>

</ul>

                <form id="main-search" class="search" action="http://search.yahoo.com/search"
        method="get" role="search">

    <input type="search" class="search-input" name="q"
            aria-label="Search docs and APIs"
            placeholder="Search docs and APIs">

    <input type="hidden" name="vs" value="yuilibrary.com">
    <input type="hidden" name="vs" value="yuiblog.com">
</form>

            </div>

            <div id="main-nav" class="yui3-u"><nav>
    <ul class="nav hoverable-group">
        
            <li class="nav-tab hoverable ">
                <a href="/yui3">Home</a>
                
            </li>
        
            <li class="nav-tab hoverable ">
                <a href="/yui3/yui/quick-start/">Quick Start</a>
                
                    <ul class="nav-submenu">
                        
                            <li class="nav-child ">
                                
                                    <a href="/yui3/yui/configurator/">Configurator</a>
                                
                            </li>
                        
                            <li class="nav-child ">
                                
                                    <a href="/download/yui3/">Download YUI 3</a>
                                
                            </li>
                        
                    </ul>
                
            </li>
        
            <li class="nav-tab hoverable  nav-tab-active">
                <a href="/yui3/yui/docs/">Documentation</a>
                
                    <ul class="nav-submenu">
                        
                            <li class="nav-child ">
                                
                                    <a href="/yui3/yui/docs/guides/">User Guides</a>
                                
                            </li>
                        
                            <li class="nav-child ">
                                
                                    <a href="/yui3/yui/docs/examples/">Examples</a>
                                
                            </li>
                        
                            <li class="nav-child ">
                                
                                    <a href="/yui3/yui/docs/tutorials/">Tutorials</a>
                                
                            </li>
                        
                            <li class="nav-child ">
                                
                                    <a href="/yui3/yui/docs/api/">API Docs</a>
                                
                            </li>
                        
                    </ul>
                
            </li>
        
            <li class="nav-tab hoverable nav-break">
                <a href="/community/">Community</a>
                
                    <ul class="nav-submenu">
                        
                            <li class="nav-child ">
                                
                                    <a href="/gallery/">Gallery</a>
                                
                            </li>
                        
                            <li class="nav-child ">
                                
                                    <a href="http://yuiblog.com/" target="_blank" title="External link">Blog &#187;</a>
                                
                            </li>
                        
                            <li class="nav-child ">
                                
                                    <a href="/forum/">Forums</a>
                                
                            </li>
                        
                            <li class="nav-child ">
                                
                                    <a href="/theater/">YUI Theater</a>
                                
                            </li>
                        
                            <li class="nav-child ">
                                
                                    <a href="/projects/yui3/calendar/">Calendar</a>
                                
                            </li>
                        
                    </ul>
                
            </li>
        
            <li class="nav-tab hoverable ">
                <a href="/contribute/">Contribute</a>
                
                    <ul class="nav-submenu">
                        
                            <li class="nav-child ">
                                
                                    <a href="https://github.com/yui/" target="_blank" title="External link">YUI on GitHub &#187;</a>
                                
                            </li>
                        
                            <li class="nav-child ">
                                
                                    <a href="/projects/yui3/newticket/">File a Ticket</a>
                                
                            </li>
                        
                            <li class="nav-child ">
                                
                                    <a href="/projects/yui3/report/">View Tickets</a>
                                
                            </li>
                        
                            <li class="nav-child ">
                                
                                    <a href="/projects/yui3/dashboard/">Dashboard</a>
                                
                            </li>
                        
                    </ul>
                
            </li>
        
            <li class="nav-tab hoverable ">
                <a href="/projects/">Other Projects</a>
                
                    <ul class="nav-submenu">
                        
                            <li class="nav-child ">
                                
                                    <a href="/projects/yui2/">YUI 2</a>
                                
                            </li>
                        
                            <li class="nav-child ">
                                
                                    <a href="/projects/yuicompressor/">YUI Compressor</a>
                                
                            </li>
                        
                            <li class="nav-child ">
                                
                                    <a href="/projects/yuidoc/">YUI Doc</a>
                                
                            </li>
                        
                            <li class="nav-child ">
                                
                                    <a href="/projects/builder/">YUI Builder</a>
                                
                            </li>
                        
                            <li class="nav-child ">
                                
                                    <a href="/projects/phploader/">YUI PHP Loader</a>
                                
                            </li>
                        
                            <li class="nav-child ">
                                
                                    <a href="/projects/yuitest/">YUI Test</a>
                                
                            </li>
                        
                            <li class="nav-child ">
                                
                                    <a href="/projects/yuilibrary/">YUI Website</a>
                                
                            </li>
                        
                    </ul>
                
            </li>
        
    </ul>
</nav></div>

        </div>
    </header></div>

    <div id="bd" class="clearfix yui3-g">
        
    <div id="breadcrumbs" class="yui3-u-1">
        <ul class="breadcrumbs">
            
                <li class="crumb"><a href="/yui3/yui/docs/">YUI</a></li>
                
                    <li class="separator">&gt;</li>
                
            
                <li class="crumb"><a href="/yui3/yui/utilities/">Utilities</a></li>
                
                    <li class="separator">&gt;</li>
                
            
                <li class="crumb"><a href="/yui3/yui/docs/uploader/">Uploader</a></li>
                
                    <li class="separator">&gt;</li>
                
            
                <li class="crumb"><a href="/yui3/yui/docs/uploader/uploader-withvars.html">Example: Single File Upload with Additional Data</a></li>
                
            
        </ul>
    </div>


        
    
        <div class="project-version yui3-u">Version 3.4.1</div>
    



        

        
            
    


            




<div class="yui3-u-1">
    <div id="docs-hd" class="content">
        <h1>Example: Single File Upload with Additional Data</h1>

        
    </div>
</div>

<div class="yui3-u-3-4 print-max-width">
    <div id="docs-main" class="content">
        <div class="intro">
<p>This example extends the single file upload example and shows how to submit GET and POST variables along with the file upload request, and how to receive data from the server. The uploader is set up to filter extensions of uploaded files to only allow common image and video formats.</p>

<p><strong>Please note:</strong> This example will not work when run from a local filesystem because Flash only allows ExternalInterface communication with pages loaded from the network. If youâ€™d like to run this example locally, set up a local web server and launch it from there. </p>
<p><strong>Also note:</strong> The uploader is not supported on iOS devices (iPhone and iPad), because Flash player is not available on that system. This example will not function on such devices.</p>
</div>

<div class="example yui3-skin-sam">
    <style type="text/css">
    .uploadButton a {
        display:block;
        width:100px;
        height:40px;
        text-decoration: none;
    }

    .uploadButton a {
        background: url("../assets/uploader/uploadFileButton.png") 0 0 no-repeat;
    }

    .uploadButton a:visited {
        background-position: 0 0;
    }

    .uploadButton a:hover { 
        background-position: 0 -40px;
    }

    .uploadButton a:active {
        background-position: 0 -80px;
    }
</style>

<div id="selectButton" style="width:100px;height:40px"></div> 
<div class="uploadButton"><a href="#" id="uploadButtonLink"></a></div>

<div id="filename">
File selected:
</div>
<div id="percent">
Percent uploaded:
</div>
<div>Sending via GET: foo='bar', foo1='bar1'</div>
<div>Sending via POST: bar='bazz', bar1='bazz1'</div>
<div id="result">Data returned from the server:</div>

<script>

YUI({filter:"raw"}).use('uploader', function (Y) {

 
var swfURL = Y.Env.cdn + "uploader/assets/uploader.swf";


if (Y.UA.ie >= 6) {
    swfURL += "?t=" + Y.guid();
}

var uploader = new Y.Uploader({boundingBox:"#selectButton", 
                               buttonSkin:"../assets/uploader/selectFileButton.png",
                               transparent: false,
                               swfURL: swfURL
                               });  

uploader.on("uploaderReady", setupUploader);
uploader.on("fileselect", fileSelect);
uploader.on("uploadprogress", updateProgress);
uploader.on("uploadcomplete", uploadComplete);
uploader.on("uploadcompletedata", uploadCompleteData);

Y.one("#uploadButtonLink").on("click", uploadFile);


function setupUploader (event) {
    uploader.set("multiFiles", false);
    uploader.set("log", true);
    
    var fileFilters = new Array({description:"Images", extensions:"*.jpg;*.png;*.gif"},
                       {description:"Videos", extensions:"*.avi;*.mov;*.mpg"}); 
    
    uploader.set("fileFilters", fileFilters);
}


function fileSelect (event) {
    var fileData = event.fileList;  

    for (var key in fileData) {
        var output = "File selected: " + fileData[key].name;
        Y.one("#filename").setContent(output);
    }
}

function updateProgress (event) {
    Y.one("#percent").setContent("Percent uploaded: " + Math.round((100 * event.bytesLoaded / event.bytesTotal)) + "%");
}

function uploadComplete (event) {
    Y.one("#percent").setContent("Upload complete!");
}

function uploadCompleteData (event) {
    Y.one("#result").setContent("Data returned from the server:<br>" + event.data);
}

function uploadFile (event) {
    uploader.uploadAll("http://www.yswfblog.com/upload/upload.php?foo=bar&foo1=bar1", "POST", {bar:"bazz", bar1:"bazz1"});
}


});

</script>
</div>

<h2>Adding Functionality to Simple File Upload</h2>

<p>Please read the "Simple File Upload" example tutorial first, since this example builds on top of it.</p>

<h2>Additional UI</h2>
<p>In addition to the UI for selecting files, uploading them, and reporting on the upload progress, add the container to output the data returned from the server:</p>

<pre class="code prettyprint">&lt;div id=&quot;result&quot;&gt;Data returned from the server:&lt;&#x2F;div&gt;</pre>


<h2>Event Binding for <code>uploadcompletedata</code></h2>
<p>When declaring uploader event bindings, add a handler for the <code>uploadcompletedata</code> event, which carries the output returned by the server:</p>

<pre class="code prettyprint">uploader.on(&quot;uploadcompletedata&quot;, uploadCompleteData);</pre>


<h2>Handling <code>uploadcompletedata</code></h2>
<p>Add a handler for the <code>uploadcompletedata</code> event. In the handler, set the content of the <code>result</code> container to the server's response to the request, carried in the event payload:</p>

<pre class="code prettyprint">function uploadCompleteData (event) {
	Y.one(&quot;#result&quot;).setContent(&quot;Data returned from the server:&lt;br&gt;&quot; + event.data);
}</pre>


<h2>Change Upload Method</h2>
<p>Finally, modify the <code>uploadAll()</code> method call to specifically set the variable transmission method to POST and to add the variables to be carried in the POST request:</p>

<pre class="code prettyprint">function uploadFile (event) {
	uploader.uploadAll(&quot;http:&#x2F;&#x2F;www.yswfblog.com&#x2F;upload&#x2F;upload.php?foo=bar&amp;foo1=bar1&quot;, &quot;POST&quot;, {bar:&quot;bazz&quot;, bar1:&quot;bazz1&quot;});
}</pre>


<h2>Full Source Code For this Example</h2>

<pre class="code prettyprint">&lt;style type=&quot;text&#x2F;css&quot;&gt;
    .uploadButton a {
        display:block;
        width:100px;
        height:40px;
        text-decoration: none;
    }

    .uploadButton a {
        background: url(&quot;..&#x2F;assets&#x2F;uploader&#x2F;uploadFileButton.png&quot;) 0 0 no-repeat;
    }

    .uploadButton a:visited {
        background-position: 0 0;
    }

    .uploadButton a:hover { 
        background-position: 0 -40px;
    }

    .uploadButton a:active {
        background-position: 0 -80px;
    }
&lt;&#x2F;style&gt;

&lt;div id=&quot;selectButton&quot; style=&quot;width:100px;height:40px&quot;&gt;&lt;&#x2F;div&gt; 
&lt;div class=&quot;uploadButton&quot;&gt;&lt;a href=&quot;#&quot; id=&quot;uploadButtonLink&quot;&gt;&lt;&#x2F;a&gt;&lt;&#x2F;div&gt;

&lt;div id=&quot;filename&quot;&gt;
File selected:
&lt;&#x2F;div&gt;
&lt;div id=&quot;percent&quot;&gt;
Percent uploaded:
&lt;&#x2F;div&gt;
&lt;div&gt;Sending via GET: foo=&#x27;bar&#x27;, foo1=&#x27;bar1&#x27;&lt;&#x2F;div&gt;
&lt;div&gt;Sending via POST: bar=&#x27;bazz&#x27;, bar1=&#x27;bazz1&#x27;&lt;&#x2F;div&gt;
&lt;div id=&quot;result&quot;&gt;Data returned from the server:&lt;&#x2F;div&gt;

&lt;script&gt;

YUI({filter:&quot;raw&quot;}).use(&#x27;uploader&#x27;, function (Y) {

 
var swfURL = Y.Env.cdn + &quot;uploader&#x2F;assets&#x2F;uploader.swf&quot;;


if (Y.UA.ie &gt;= 6) {
    swfURL += &quot;?t=&quot; + Y.guid();
}

var uploader = new Y.Uploader({boundingBox:&quot;#selectButton&quot;, 
                               buttonSkin:&quot;..&#x2F;assets&#x2F;uploader&#x2F;selectFileButton.png&quot;,
                               transparent: false,
                               swfURL: swfURL
                               });  

uploader.on(&quot;uploaderReady&quot;, setupUploader);
uploader.on(&quot;fileselect&quot;, fileSelect);
uploader.on(&quot;uploadprogress&quot;, updateProgress);
uploader.on(&quot;uploadcomplete&quot;, uploadComplete);
uploader.on(&quot;uploadcompletedata&quot;, uploadCompleteData);

Y.one(&quot;#uploadButtonLink&quot;).on(&quot;click&quot;, uploadFile);


function setupUploader (event) {
    uploader.set(&quot;multiFiles&quot;, false);
    uploader.set(&quot;log&quot;, true);
    
    var fileFilters = new Array({description:&quot;Images&quot;, extensions:&quot;*.jpg;*.png;*.gif&quot;},
                       {description:&quot;Videos&quot;, extensions:&quot;*.avi;*.mov;*.mpg&quot;}); 
    
    uploader.set(&quot;fileFilters&quot;, fileFilters);
}


function fileSelect (event) {
    var fileData = event.fileList;  

    for (var key in fileData) {
        var output = &quot;File selected: &quot; + fileData[key].name;
        Y.one(&quot;#filename&quot;).setContent(output);
    }
}

function updateProgress (event) {
    Y.one(&quot;#percent&quot;).setContent(&quot;Percent uploaded: &quot; + Math.round((100 * event.bytesLoaded &#x2F; event.bytesTotal)) + &quot;%&quot;);
}

function uploadComplete (event) {
    Y.one(&quot;#percent&quot;).setContent(&quot;Upload complete!&quot;);
}

function uploadCompleteData (event) {
    Y.one(&quot;#result&quot;).setContent(&quot;Data returned from the server:&lt;br&gt;&quot; + event.data);
}

function uploadFile (event) {
    uploader.uploadAll(&quot;http:&#x2F;&#x2F;www.yswfblog.com&#x2F;upload&#x2F;upload.php?foo=bar&amp;foo1=bar1&quot;, &quot;POST&quot;, {bar:&quot;bazz&quot;, bar1:&quot;bazz1&quot;});
}


});

&lt;&#x2F;script&gt;</pre>



    </div>
</div>

<div class="yui3-u-1-4">
    <div id="docs-sidebar" class="sidebar">
        
            
        

        

        
            
                <div class="sidebox">
                    <div class="hd">
                        <h2 class="no-toc">Examples</h2>
                    </div>

                    <div class="bd">
                        <ul class="examples">
                            
                                
                                    <li data-description="How to upload a single file, while tracking progress and using a sprite-skinned button">
                                        <a href="uploader-simple.html">Simple Uploader with Progress Tracking</a>
                                    </li>
                                
                            
                                
                                    <li data-description="How to upload a single file, along with GET and POST Vars Submission and receive data from the server">
                                        <a href="uploader-withvars.html">Single File Upload with Additional Data</a>
                                    </li>
                                
                            
                                
                                    <li data-description="How to upload multiple files with progress tracking and a transparent overlay upload button">
                                        <a href="uploader-multiple.html">Multiple Files Upload with Transparent Overlay Button</a>
                                    </li>
                                
                            
                        </ul>
                    </div>
                </div>
            
        

        
    </div>
</div>




        
    </div>

    <div id="ft"><footer>
        <p class="copyright">
        &copy; 2006-2011 Yahoo! Inc. All rights reserved.<br>
        All code on this site is licensed under the <a href="/license/">BSD License</a> unless stated otherwise.<br>
        <span class="links"><a href="/about/">About This Site</a> &middot; <a href="/security/">Security Contact Info</a></span>
        </p>
    </footer></div>
</div>






    <script src="/yui3/combo/js-search-min.js-hoverable-min.js-main-min.js"></script>



    <script src="/yui3/vendor/prettify/prettify-min.js"></script>
    <script>prettyPrint();</script>



<script>
var _sf_async_config={uid:27522,domain:"yuilibrary.com"};

(function(){
  var win       = window,
      oldonload = win.onload;

  win.onload = typeof win.onload !== 'function' ?
    loadChartbeat : function () { oldonload(); loadChartbeat(); };

  function loadChartbeat() {
    var doc = document,
        el;

    win._sf_endpt=(new Date()).getTime();

    el = doc.createElement('script');
    el.setAttribute('src', ('https:' === win.location.protocol ?
      'https://a248.e.akamai.net/chartbeat.download.akamai.com/102508/' :
      'http://static.chartbeat.com/') + 'js/chartbeat.js');

    doc.body.appendChild(el);
  }
})();
</script>

</body>
</html>
